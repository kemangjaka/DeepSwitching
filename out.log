WARNING:tensorflow:From /mnt/ssd2/ryo/DeepSwitching/utils/tb_logger.py:37: The name tf.summary.FileWriter is deprecated. Please use tf.compat.v1.summary.FileWriter instead.

tensor(4.2139, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.1746, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.1420, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.1188, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.0900, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.0595, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.0450, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.0167, device='cuda:0', grad_fn=<SumBackward0>)
tensor(4.0113, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9946, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9723, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9473, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9365, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9210, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.9101, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8797, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8808, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8540, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8345, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8122, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7895, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7872, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7544, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7456, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7177, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.7103, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.6857, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.6388, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.6172, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.6179, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.5772, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.5523, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.5279, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.5068, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.4814, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.4634, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.4204, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3834, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3588, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3321, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3063, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.2691, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.2685, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1901, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.2093, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1690, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1186, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.0728, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1076, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.0815, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.0478, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9883, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.0457, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8707, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9336, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9031, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8999, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7499, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7612, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6815, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8601, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7932, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7721, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7710, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7373, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7747, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7435, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6462, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7730, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5054, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.0902, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6580, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7047, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8281, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9395, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7379, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7637, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7672, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8309, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3851, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3978, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8533, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5945, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8548, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9424, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5418, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.2700, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8354, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1088, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5788, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9680, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1243, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7542, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5478, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7706, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4268, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4658, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4851, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6344, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1190, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2492, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8292, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8645, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5674, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6459, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4625, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5358, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9747, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1746, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3334, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6487, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5953, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4855, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6387, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1931, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4569, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4085, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2587, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1041, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4394, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4665, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0727, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8729, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7348, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3348, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8721, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8009, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8884, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8951, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9456, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9555, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4843, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3775, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.1698, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5945, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8698, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4261, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8463, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2388, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3682, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5739, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1014, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5399, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0692, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9886, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3352, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1091, device='cuda:0', grad_fn=<SumBackward0>)epoch    0    time 2661.64     nsample 3346   loss 2.6320 
WARNING:tensorflow:From /mnt/ssd2/ryo/DeepSwitching/utils/tb_logger.py:42: The name tf.Summary is deprecated. Please use tf.compat.v1.Summary instead.


tensor(2.3634, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3875, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1298, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7097, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1692, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6522, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0521, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5255, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2754, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4023, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8897, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7746, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.3810, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.4944, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6662, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2941, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0779, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7204, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7264, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0182, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7709, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7643, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3193, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8566, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9771, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0590, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7260, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9534, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3672, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.5294, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8935, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8387, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8490, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6515, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.4629, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2862, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.3644, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3966, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7650, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.1644, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.4509, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9705, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6344, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7943, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.1153, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6173, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6516, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9490, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9070, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.2753, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0988, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7161, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.5657, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.5003, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1521, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.5033, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6514, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.3256, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.2555, device='cuda:0', grad_fn=<SumBackward0>)
tensor(0.8017, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.9675, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1157, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.7628, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5565, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8519, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8274, device='cuda:0', grad_fn=<SumBackward0>)
tensor(3.8506, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.2622, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7168, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8395, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.9421, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6507, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7353, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5535, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1108, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3136, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0926, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.6196, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.8727, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2174, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.7792, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.2373, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0646, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.1023, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.5498, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8229, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.0593, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3535, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.8498, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.6256, device='cuda:0', grad_fn=<SumBackward0>)
tensor(1.4372, device='cuda:0', grad_fn=<SumBackward0>)
tensor(2.3516, device='cuda:0', grad_fn=<SumBackward0>)
Traceback (most recent call last):
  File "switching/train.py", line 128, in <module>
    tb_logger.scalar_summary(['loss', 'ce_loss', 'switch_loss'], [tr_loss, tr_cat_loss, tr_sw_loss], i_epoch)
  File "/mnt/ssd2/ryo/DeepSwitching/utils/tb_logger.py", line 42, in scalar_summary
    summary = tf.Summary(value=[tf.Summary.Value(tag=tag, simple_value=value)])
TypeError: tensor([12.9998, 12.9998, 12.9998, 12.9979, 12.9998, 12.9998],
       grad_fn=<DivBackward0>) has type Tensor, but expected one of: int, long, float
